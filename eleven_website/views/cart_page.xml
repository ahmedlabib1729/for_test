<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Custom Cart Page -->
    <template id="eleven_cart_page" name="Eleven Cart Page">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure">

                <!-- Breadcrumb -->
                <section class="eleven_breadcrumb">
                    <div class="container">
                        <nav>
                            <a href="/">Home</a> /
                            <a href="/products">Products</a> /
                            <span>Shopping Cart</span>
                        </nav>
                    </div>
                </section>

                <section class="eleven_cart_section">
                    <div class="container">

                        <h1 class="eleven_cart_title">Shopping Cart</h1>

                        <!-- Empty Cart -->
                        <t t-if="not order or not order_lines">
                            <div class="eleven_empty_cart">
                                <i class="fa fa-shopping-cart"></i>
                                <h2>Your cart is empty</h2>
                                <p>Looks like you haven't added anything to your cart yet.</p>
                                <a href="/products" class="eleven_btn_continue">
                                    <i class="fa fa-arrow-left"></i> Continue Shopping
                                </a>
                            </div>
                        </t>

                        <!-- Cart with Items -->
                        <t t-if="order and order_lines">
                            <div class="eleven_cart_container">

                                <!-- Cart Items -->
                                <div class="eleven_cart_items">
                                    <t t-foreach="order_lines" t-as="line">
                                        <div class="eleven_cart_item">

                                            <!-- Product Image -->
                                            <div class="eleven_cart_item_image">
                                                <a t-attf-href="/product/#{line.product_id.id}">
                                                    <img t-attf-src="/web/image/product.product/#{line.product_id.id}/image_256"
                                                         t-att-alt="line.product_id.display_name"/>
                                                </a>
                                            </div>

                                            <!-- Product Details -->
                                            <div class="eleven_cart_item_details">
                                                <h3 class="eleven_cart_item_name">
                                                    <a t-attf-href="/product/#{line.product_id.id}"
                                                       t-esc="line.product_id.display_name"/>
                                                </h3>

                                                <!-- Attributes -->
                                                <t t-if="line.product_id.product_template_attribute_value_ids">
                                                    <div class="eleven_cart_item_attributes">
                                                        <t t-foreach="line.product_id.product_template_attribute_value_ids" t-as="attr">
                                                            <span class="eleven_attribute_badge">
                                                                <strong t-esc="attr.attribute_id.name"/>:
                                                                <t t-esc="attr.name"/>
                                                            </span>
                                                        </t>
                                                    </div>
                                                </t>

                                                <!-- Stock Status -->
                                                <div class="eleven_cart_item_stock">
                                                    <t t-if="line.product_id.qty_available > 0">
                                                        <span class="eleven_in_stock">
                                                            <i class="fa fa-check-circle"/> In Stock
                                                        </span>
                                                    </t>
                                                    <t t-else="">
                                                        <span class="eleven_out_stock">
                                                            <i class="fa fa-exclamation-circle"/> Out of Stock
                                                        </span>
                                                    </t>
                                                </div>
                                            </div>

                                            <!-- Price -->
                                            <div class="eleven_cart_item_price">
                                                <span t-field="line.price_unit"
                                                      t-options="{'widget': 'monetary', 'display_currency': order.currency_id}"/>
                                            </div>

                                            <!-- Quantity -->
                                            <div class="eleven_cart_item_quantity">
                                                <form t-attf-action="/cart/update" method="POST">
                                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                                    <input type="hidden" name="product_id" t-att-value="line.product_id.id"/>

                                                    <div class="eleven_qty_control">
                                                        <button type="submit" name="add_qty" value="-1" class="eleven_qty_btn">
                                                            <i class="fa fa-minus"/>
                                                        </button>
                                                        <input type="number"
                                                               class="eleven_qty_input"
                                                               name="set_qty"
                                                               t-att-value="int(line.product_uom_qty)"
                                                               min="1"
                                                               t-att-max="int(line.product_id.qty_available)"
                                                               onchange="this.form.submit()"/>
                                                        <button type="submit" name="add_qty" value="1" class="eleven_qty_btn">
                                                            <i class="fa fa-plus"/>
                                                        </button>
                                                    </div>
                                                </form>
                                            </div>

                                            <!-- Subtotal -->
                                            <div class="eleven_cart_item_subtotal">
                                                <span t-field="line.price_subtotal"
                                                      t-options="{'widget': 'monetary', 'display_currency': order.currency_id}"/>
                                            </div>

                                            <!-- Remove Button -->
                                            <div class="eleven_cart_item_remove">
                                                <a t-attf-href="/cart/delete/#{line.id}?csrf_token=#{request.csrf_token()}"
                                                   class="eleven_remove_btn"
                                                   onclick="return confirm('Remove this item from cart?')">
                                                    <i class="fa fa-trash"/>
                                                </a>
                                            </div>

                                        </div>
                                    </t>
                                </div>

                                <!-- Cart Summary -->
                                <div class="eleven_cart_summary">
                                    <h2 class="eleven_summary_title">Order Summary</h2>

                                    <div class="eleven_summary_row">
                                        <span>Subtotal:</span>
                                        <strong t-field="order.amount_untaxed"
                                                t-options="{'widget': 'monetary', 'display_currency': order.currency_id}"/>
                                    </div>

                                    <div class="eleven_summary_row">
                                        <span>Tax:</span>
                                        <strong t-field="order.amount_tax"
                                                t-options="{'widget': 'monetary', 'display_currency': order.currency_id}"/>
                                    </div>

                                    <div class="eleven_summary_divider"></div>

                                    <div class="eleven_summary_row eleven_summary_total">
                                        <span>Total:</span>
                                        <strong t-field="order.amount_total"
                                                t-options="{'widget': 'monetary', 'display_currency': order.currency_id}"/>
                                    </div>

                                    <a href="/shop/checkout" class="eleven_btn_checkout">
                                        <i class="fa fa-lock"/> Proceed to Checkout
                                    </a>

                                    <a href="/products" class="eleven_btn_continue_shopping">
                                        <i class="fa fa-arrow-left"/> Continue Shopping
                                    </a>
                                </div>

                            </div>

                            <!-- Suggested Products -->
                            <t t-if="suggested_products">
                                <div class="eleven_suggested_products">
                                    <h2 class="eleven_section_title">You May Also Like</h2>
                                    <div class="eleven_suggested_grid">
                                        <t t-foreach="suggested_products" t-as="product">
                                            <div class="eleven_suggested_card">
                                                <a t-attf-href="/product/#{product.id}">
                                                    <img t-attf-src="/web/image/product.product/#{product.id}/image_512"
                                                         t-att-alt="product.display_name"/>
                                                    <h4 t-esc="product.display_name"/>
                                                    <p class="eleven_suggested_price">
                                                        <span t-field="product.list_price"
                                                              t-options="{'widget': 'monetary', 'display_currency': product.currency_id}"/>
                                                    </p>
                                                </a>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </t>

                        </t>

                    </div>
                </section>

            </div>
        </t>
    </template>

</odoo>